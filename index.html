<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Page title - reflects the current level in the game -->
    <title>Architecture Simulator: Level 1 - Performance Bottleneck</title>
    <!-- Link to custom styles for the application UI -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- Import Phaser 3 game framework from CDN for rendering game graphics and handling game logic -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>
    <!-- Top Header Section: Displays level title and legend for visual elements -->
    <div id="header">
        <div style="display: flex; align-items: center; gap: 20px;">
            <h1>Level 1: Monolithic Architecture Scaling</h1>
            <!-- Level Selection Dropdown -->
            <select id="level-selector" style="
                background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
                color: white;
                padding: 8px 16px;
                font-size: 14px;
                border: 2px solid #5aa3ff;
                border-radius: 6px;
                cursor: pointer;
                box-shadow: 0 3px 8px rgba(74, 144, 226, 0.4);
                font-weight: 600;
            ">
                <option value="" style="background-color: #2a2a2a; color: white;">üìã Select Level</option>
                <option value="1" style="background-color: #2a2a2a; color: white;">Level 1: Monolithic Architecture</option>
                <option value="2" style="background-color: #2a2a2a; color: white;">Level 2: Database Integration</option>
                <option value="3" style="background-color: #2a2a2a; color: white;">Level 3: Database Scaling</option>
                <option value="4" style="background-color: #2a2a2a; color: white;">Level 4: App Server Scaling</option>
                <option value="5" style="background-color: #2a2a2a; color: white;">Level 5: Cache Layer</option>
                <option value="6" style="background-color: #2a2a2a; color: white;">Level 6: Load Balancer</option>
                <option value="7" style="background-color: #2a2a2a; color: white;">Level 7: CDN Layer</option>
                <option value="8" style="background-color: #2a2a2a; color: white;">Level 8: Read Replicas</option>
                <option value="9" style="background-color: #2a2a2a; color: white;">Level 9: Message Queue</option>
            </select>
        </div>
        <!-- Legend box: Explains the meaning of colored dots/elements in the game -->
        <div class="legend-box">
            <!-- Cyan circle represents read requests -->
            <span><span class="legend-dot" style="background:#00ffff; border-radius:50%;"></span>Read (circle)</span>
            <!-- Cyan diamond represents write requests (Level 2 only) -->
            <span><span class="legend-dot" style="background:#00ffff; transform: rotate(45deg);"></span>Write (diamond)</span>
            <!-- Gold dot represents outgoing responses -->
            <span><span class="legend-dot" style="background:#ffd700; border-radius:50%;"></span>Response</span>
            <!-- Display the level objective: process 1000 requests with less than 1% error rate -->
            <span style="color:#ffd700; margin-left:10px;">Goal: 1000 Requests & Error Rate < 1%</span>
        </div>
    </div>

    <!-- Main Content Area: Contains the game interface divided into left sidebar and right content -->
    <div id="main-content">
        <!-- Left Sidebar: Displays monitoring statistics and objectives -->
        <div id="left-sidebar">
            <!-- Monitoring Section: Real-time statistics about request processing -->
            <div class="sidebar-section">
                <h3>Monitoring</h3>
                <!-- Total requests processed - goal is 1000 -->
                <div class="stat-item">
                    <span class="stat-label">Progress (1000):</span>
                    <span class="stat-value" id="stat-total">0</span>
                </div>
                <!-- Count of successfully processed requests (shown in green) -->
                <div class="stat-item">
                    <span class="stat-label">Success:</span>
                    <span class="stat-value" style="color:#00ff00" id="stat-success">0</span>
                </div>
                <!-- Count of failed requests (shown in red) -->
                <div class="stat-item">
                    <span class="stat-label">Errors:</span>
                    <span class="stat-value" style="color:#ff4444" id="stat-errors">0</span>
                </div>
                <!-- Visual divider to separate basic stats from calculated metrics -->
                <div class="stat-divider"></div>
                <!-- Calculated error rate percentage (errors / total * 100) -->
                <div class="stat-item">
                    <span class="stat-label">Error Rate:</span>
                    <span class="stat-value" id="stat-rate">0.0%</span>
                </div>
                <!-- Current system load indicator (Low/Medium/High) based on concurrent requests -->
                <div class="stat-item">
                    <span class="stat-label">Current Load:</span>
                    <span class="stat-value" id="stat-load" style="color:#00ffff">Low</span>
                </div>
                <!-- Database storage indicator (only visible in Level 2) -->
                <div class="stat-item" id="stat-db-storage-container" style="display:none;">
                    <span class="stat-label">DB Storage:</span>
                    <span class="stat-value" id="stat-db-storage" style="color:#ff6b35">0</span>
                </div>
                <!-- Database speed indicator (only visible in Level 2) -->
                <div class="stat-item" id="stat-db-speed-container" style="display:none;">
                    <span class="stat-label">DB Speed:</span>
                    <span class="stat-value" id="stat-db-speed" style="color:#ffff00">800ms</span>
                </div>
            </div>

            <!-- Objectives Section: Lists the goals players need to achieve -->
            <div class="sidebar-section">
                <h3>Objectives</h3>
                <ul class="objectives-list">
                    <!-- Primary objective: process all 1000 requests -->
                    <li>Complete 1000 requests</li>
                    <!-- Quality objective: keep error rate below 1% threshold -->
                    <li>Maintain error rate < 1%</li>
                    <!-- Resource management: don't waste money on unnecessary upgrades -->
                    <li>Manage your budget wisely</li>
                </ul>
            </div>
        </div>

        <!-- Right Content Area: Contains the main game canvas and control panel -->
        <div id="right-content">
            <!-- Architecture Display Area: Container for the Phaser game canvas -->
            <div id="architecture-area">
                <!-- The Phaser game will inject its canvas into this container -->
                <div id="game-container"></div>
            </div>

            <!-- Control Panel: Bottom panel with budget display and action buttons -->
            <div id="control-panel">
                <!-- Budget Display: Shows remaining money for upgrades -->
                <div class="budget-display">
                    Budget: $<span id="ui-money">500</span>
                </div>
                
                <!-- Button Group: Main control buttons for game actions -->
                <div class="button-group">
                    <!-- Start/Pause Button: Initiates/Pauses/Resumes the simulation -->
                    <button id="btn-start" class="start">
                        <span>‚ñ∂ Start</span>
                    </button>

                    <!-- Upgrade Button: Improves server capacity (costs $200) -->
                    <!-- Disabled by default, enabled when simulation starts and player has enough money -->
                    <button id="btn-upgrade" class="upgrade" disabled>
                        <span>‚¨Ü Upgrade Server ($200)</span>
                    </button>

                    <!-- Reset Button: Restarts the current level from the beginning -->
                    <button id="btn-reset" class="reset">
                        <span>‚Ü∫ Reset</span>
                    </button>

                    <!-- Skip Button: Allows player to bypass the current level (for testing/debugging) -->
                    <button id="btn-skip" class="skip">
                        <span>‚è≠ Skip Level</span>
                    </button>
                </div>
                
                <!-- Zoom Controls: Canvas zoom in/out controls -->
                <div class="button-group" style="margin-top: 10px; gap: 5px;">
                    <button id="btn-zoom-out" class="upgrade" style="padding: 8px 12px;">
                        <span>üîç‚àí</span>
                    </button>
                    <span id="zoom-level" style="color: #fff; padding: 8px 12px; background: rgba(0,0,0,0.3); border-radius: 4px; min-width: 60px; text-align: center;">100%</span>
                    <button id="btn-zoom-in" class="upgrade" style="padding: 8px 12px;">
                        <span>üîç+</span>
                    </button>
                    <button id="btn-zoom-reset" class="reset" style="padding: 8px 12px;">
                        <span>Reset Zoom</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification: Temporary alert that appears when game difficulty increases -->
    <!-- Hidden by default, shown via JavaScript when traffic surge occurs -->
    <div id="difficulty-toast">‚ö† Traffic Surge! Concurrency Increased</div>

    <!-- Result Modal: Popup dialog shown when level is completed (success or failure) -->
    <!-- Hidden by default via CSS, displayed when simulation ends -->
    <div id="result-modal">
        <!-- Modal title changes based on success/failure -->
        <h2 id="modal-title">Congratulations!</h2>
        <!-- Modal body content is dynamically generated by JavaScript -->
        <div class="modal-content" id="modal-body">
            <!-- Dynamic content will be inserted here -->
        </div>
        <!-- Modal footer contains action buttons -->
        <div class="modal-footer">
            <!-- Retry button: restart the current level -->
            <button id="btn-modal-retry" class="reset">Retry</button>
            <!-- Next level button: proceed to Level 2 -->
            <button id="btn-modal-next" class="start">Enter Level 2</button>
        </div>
    </div>

    <!-- Main JavaScript module: Entry point for the application -->
    <!-- type="module" enables ES6 module syntax (import/export) -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
